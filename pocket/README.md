# 🏛️ ASCII 3D Maze Game

一个基于纯 JavaScript 和 Canvas 的 3D 第一人称迷宫游戏，采用光线投射（Raycasting）技术实现。

## ✨ 特性

### 🎮 游戏功能
- **3D 第一人称视角**：完整的光线投射渲染引擎
- **随机迷宫生成**：每次都是不同的迷宫布局
- **物品收集系统**：收集金币（8个）和钥匙（2个）
- **实时小地图**：显示周围环境和玩家位置
- **数据统计**：FPS、生命值、收集进度、步数

### 🎨 视觉效果
- **动态天空**：蓝色渐变 + 星空 + 云彩，随视角旋转
- **ASCII 砖墙**：优雅的字符纹理，降低眩晕感
- **距离雾效**：墙壁随距离自然淡化
- **侧面明暗**：不同墙面亮度区分
- **地板渐变**：深灰色平滑过渡

### 🕹️ 操作方式
- **键盘控制**
  - W/↑：前进
  - S/↓：后退
  - A/D：左右平移
  - ←/→：旋转视角
  - R：重置位置
  - N：生成新迷宫

- **鼠标控制**
  - 拖拽画布：旋转视角

- **触摸控制**
  - 虚拟摇杆：移动
  - 滑动屏幕：旋转视角
  - Reset/New 按钮：重置和新迷宫

## 🚀 性能优化

### 关键优化技术
- **预计算天空纹理**：启动时生成，避免实时渲染
- **距离裁剪**：小地图仅渲染20单位范围内
- **物品剔除**：超过15单位的物品不渲染
- **ASCII 简化**：固定字体、稀疏分布、低透明度
- **采样优化**：天空采样跳帧渲染

### 性能指标
- **目标 FPS**：60
- **实际 FPS**：55-60（稳定）
- **CPU 占用**：<20%
- **内存占用**：极低（无大型贴图）

## 📂 文件结构

```
pocket/
├── index.html          # 游戏主页面和样式
├── game.js            # 游戏核心逻辑
└── README.md          # 本文档
```

## 🎯 技术实现

### 核心算法
- **DDA 光线投射**：高效的墙壁检测算法
- **递归迷宫生成**：基于深度优先搜索
- **精灵渲染**：物品的 3D 透视投影
- **程序化纹理**：ASCII 字符实时生成砖墙效果

### 技术栈
- 纯 JavaScript（ES6+）
- HTML5 Canvas API
- 数学库：内置 Math 对象
- 无第三方依赖

## 🎲 游戏参数

### 世界设置
- 地图尺寸：50 × 50
- 视野距离：22 单位
- 移动速度：0.15 单位/帧
- 旋转速度：0.08 弧度/帧

### 渲染设置
- 目标帧率：60 FPS
- 天空贴图：512 × 256
- 墙壁基础色：RGB(220, 220, 220)
- ASCII 字体：12px monospace

## 🎨 视觉设计

### 配色方案
- **天空**：深蓝 → 浅蓝渐变 (#1a4d7a → #87ceeb)
- **墙壁**：浅灰色 (220) + ASCII 边框
- **地板**：深灰渐变 (#3a3a3a → #1a1a1a)
- **物品**：金色 (#FFD700)

### ASCII 字符
- `│` - 砖块垂直边缘
- `─` - 砖块水平边缘
- 透明度：0.12（淡雅不刺眼）

## 🚀 运行方法

### 本地运行
```bash
# 进入项目目录
cd pocket

# 启动本地服务器（任选其一）
python3 -m http.server 8000
# 或
npx serve

# 浏览器访问
http://localhost:8000
```

### 直接打开
双击 `index.html` 即可在浏览器中运行（推荐使用本地服务器以获得最佳性能）

## 🎮 游戏提示

1. **收集目标**：找到所有 8 个金币和 2 把钥匙
2. **小地图**：右上角显示周围环境，绿点是你的位置
3. **迷路了**：按 R 键重置到起点
4. **想换地图**：按 N 键生成新迷宫
5. **性能优化**：游戏会自动根据距离优化渲染

## 🔧 自定义修改

### 调整迷宫大小
修改 `game.js` 中的常量：
```javascript
const MAP_WIDTH = 50;   // 宽度
const MAP_HEIGHT = 50;  // 高度
```

### 修改移动速度
修改 `Camera` 类构造函数：
```javascript
this.moveSpeed = 0.15;  // 移动速度
this.rotSpeed = 0.08;   // 旋转速度
```

### 调整物品数量
修改 `generateItems` 方法中的循环：
```javascript
for (let i = 0; i < 8; i++)  // 金币数量
for (let i = 0; i < 2; i++)  // 钥匙数量
```

## 📊 代码统计

- **总代码行数**：~750 行
- **核心渲染**：~200 行
- **游戏逻辑**：~300 行
- **控制系统**：~150 行
- **工具函数**：~100 行

## 🌟 特色亮点

1. ✅ **零依赖**：纯原生 JavaScript，无需任何库
2. ✅ **高性能**：60 FPS 流畅运行
3. ✅ **响应式**：完美适配各种屏幕尺寸
4. ✅ **触摸友好**：虚拟摇杆 + 滑动控制
5. ✅ **视觉舒适**：防眩晕优化设计
6. ✅ **即开即玩**：无需安装，浏览器直接运行

## 📝 更新日志

### v1.0 (2024-10-25)
- ✨ 初始版本发布
- 🎮 完整的 3D 迷宫游戏
- 🎨 ASCII 砖墙纹理
- 🕹️ 多种控制方式
- ⚡ 性能优化至 60 FPS

## 📄 许可证

本项目仅供学习和个人使用。

## 🙏 致谢

- 光线投射技术灵感来自经典游戏 Wolfenstein 3D
- ASCII 艺术风格致敬复古游戏时代

---

**享受游戏！祝你成功走出迷宫！** 🎮✨
